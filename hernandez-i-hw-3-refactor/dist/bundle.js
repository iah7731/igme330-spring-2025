(()=>{"use strict";var e,t,n,o,a,r,s,c,l=function(e,t,n,o){return void 0===o&&(o=1),"rgba(".concat(e,",").concat(t,",").concat(n,",").concat(o,")")},i=function(e,t,n,o,a){e.save(),e.beginPath(),e.fillStyle=t,e.arc(n,o,a,0,2*Math.PI,!1),e.fill(),e.closePath(),e.restore()};!function(e){e[e.gain=.5]="gain",e[e.numSamples=256]="numSamples"}(e||(e={}));var u,d,h,f,v,p,g,y,m,w,S,b,q,k,M,x=function(e){n.src=e},V=.05,T=function(e,t,n,o,a,r,s){var c=this;this.update=function(){c.colorUpdate(),"yes"==document.querySelector("#play-btn").dataset.playing&&((c.x+c.xMoveSpeed>c.canvasWidth-c.radius||c.x+c.xMoveSpeed<c.radius)&&(c.xMoveSpeed=-c.xMoveSpeed),(c.y+c.yMoveSpeed>c.canvasHeight-c.radius||c.y+c.yMoveSpeed<c.radius)&&(c.yMoveSpeed=-c.yMoveSpeed),c.x+=c.xMoveSpeed,c.y+=c.yMoveSpeed)},this.draw=function(e){"yes"==document.querySelector("#play-btn").dataset.playing&&i(e,c.color,c.x,c.y,c.radius)},this.colorUpdate=function(){for(var e=0,t=0;t<p.length;t++)e+=p[t];e/=p.length,c.color=l(e,e,e,255)},this.x=e,this.y=t,this.radius=n,this.color=l(0,0,0,255),this.xMoveSpeed=o,this.yMoveSpeed=a,this.canvasWidth=r,this.canvasHeight=s},E={showGradient:!0,showBars:!0,showCircles:!0,showNoise:!1,showInvert:!1,showEmboss:!1,highshelf:!1,lowshelf:!1},A=function(){var l,i,m;console.log("init called"),console.log("Testing utils.getRandomColor() import: ".concat("rgba(".concat((m=function(){return 185*Math.random()+35})(),",").concat(m(),",").concat(m(),",1)"))),l=M.sound1,i=window.AudioContext,t=new i,n=new Audio,x(l),o=t.createMediaElementSource(n),(a=t.createAnalyser()).fftSize=e.numSamples,(r=t.createGain()).gain.value=e.gain,(s=t.createBiquadFilter()).type="highshelf",(c=t.createBiquadFilter()).type="lowshelf",o.connect(c),c.connect(s),s.connect(r),r.connect(a),a.connect(t.destination);var w=document.querySelector("canvas");R(w),function(e,t){u=e.getContext("2d"),d=e.width,h=e.height,f=function(e,t,n,o,a){for(var r=e.createLinearGradient(0,0,0,a),s=0,c=[{percent:0,color:"#d70071"},{percent:1,color:"#0035a9"},{percent:.5,color:"#9c4e97"}];s<c.length;s++){var l=c[s];r.addColorStop(l.percent,l.color)}return r}(u,0,0,0,h),v=t,p=new Uint8Array(v.fftSize/2),g=document.querySelector("#radio-frequency-data"),y=document.querySelector("#radio-time-domain")}(w,a),L()},F=function(){E.highshelf?(s.frequency.setValueAtTime(1e3,t.currentTime),s.gain.setValueAtTime(25,t.currentTime)):s.gain.setValueAtTime(0,t.currentTime)},C=function(){E.lowshelf?(c.frequency.setValueAtTime(1e3,t.currentTime),c.gain.setValueAtTime(15,t.currentTime)):c.gain.setValueAtTime(0,t.currentTime)},R=function(e){var o=document.querySelector("#fs-btn"),a=document.querySelector("#play-btn"),s=document.querySelector("#cb-highshelf"),c=document.querySelector("#cb-lowshelf");s.checked=E.highshelf,s.onchange=function(e){E.highshelf=e.target.checked,F()},F(),c.checked=E.lowshelf,c.onchange=function(e){E.lowshelf=e.target.checked,C()},C(),o.onclick=function(t){var n;console.log("goFullscreen() called"),(n=e).requestFullscreen?n.requestFullscreen():n.mozRequestFullscreen?n.mozRequestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen&&n.webkitRequestFullscreen()},a.onclick=function(e){var o=e.target;console.log("audioCtx.state before = ${audio.audioCtx.state}"),"suspended"==t.state&&t.resume(),console.log("audioCtx.state after = ${audio.audioCtx.state}"),"no"==o.dataset.playing?(n.play(),o.dataset.playing="yes"):(n.pause(),o.dataset.playing="no")};var l=document.querySelector("#slider-volume"),i=document.querySelector("#label-volume");l.oninput=function(){var e;e=parseFloat(l.value),e=Number(e),r.gain.value=e,i.innerHTML="".concat(Math.round(parseFloat(l.value)/2*100))},l.dispatchEvent(new Event("input"));var u=document.querySelector("#slider-noise"),d=document.querySelector("#label-noise");u.oninput=function(){var e;e=parseFloat(u.value),V=e,d.innerHTML="".concat(Math.round(parseFloat(u.value)/2*100))},u.dispatchEvent(new Event("input")),k.onchange=function(){x(k.value),"yes"==a.dataset.playing&&a.dispatchEvent(new MouseEvent("click"))};var h=document.querySelector("#cb-gradient"),f=document.querySelector("#cb-bars"),v=document.querySelector("#cb-circles"),p=document.querySelector("#cb-noise"),g=document.querySelector("#cb-invert"),y=document.querySelector("#cb-emboss");h.addEventListener("change",(function(){h.checked?E.showGradient=!0:E.showGradient=!1})),f.addEventListener("change",(function(){f.checked?E.showBars=!0:E.showBars=!1})),v.addEventListener("change",(function(){v.checked?E.showCircles=!0:E.showCircles=!1})),p.addEventListener("change",(function(){p.checked?E.showNoise=!0:E.showNoise=!1})),g.addEventListener("change",(function(){g.checked?E.showInvert=!0:E.showInvert=!1})),y.addEventListener("change",(function(){y.checked?E.showEmboss=!0:E.showEmboss=!1}))},L=function(){setTimeout(L,17),m.update(),w.update(),S.update(),b.update(),function(e){g.checked&&v.getByteFrequencyData(p),y.checked&&v.getByteTimeDomainData(p),u.save(),u.fillStyle="black",u.globalAlpha=.1,u.fillRect(0,0,d,h),u.restore(),e.showGradient&&(u.save(),u.fillStyle=f,u.globalAlpha=.3,u.fillRect(0,0,d,h),u.restore());var t=(d-4*p.length-10)/p.length;if(e.showBars&&g.checked){var n=200,o=100;u.save(),u.fillStyle="rgba(255,255,255,0.50)",u.strokeStyle="rgba(0,0,0,0.50)";for(var a=0;a<p.length;a++)u.fillRect(5+a*(t+4),o+256-p[a],t,n),u.strokeRect(5+a*(t+4),o+256-p[a],t,n);u.restore()}else if(e.showBars&&y.checked){for(n=10,o=100,u.save(),u.strokeStyle="rgba(255,255,255,0.50)",u.fillStyle="rgba(0,0,0,0.50)",a=0;a<p.length;a++)u.fillRect(5+a*(t+4),o+256-p[a],t,n),u.strokeRect(5+a*(t+4),o+256-p[a],t,n);u.restore()}if(e.showCircles&&g.checked){var r=h/4;for(u.save(),u.globalAlpha=.5,a=0;a<p.length;a++){var s=(c=p[a]/255)*r;i(u,l(99,177,104,.34-c/3),d/2,h/2,s),i(u,l(40,255,142,.1-c/10),d/2,h/2,1.5*s),i(u,l(255,202,86,.5-c/5),d/2,h/2,.5*s)}u.restore()}else if(e.showCircles&&y.checked){for(r=h/8,u.save(),u.globalAlpha=.5,a=0;a<p.length;a++)if(p[a]/255>=.502){var c;s=(c=p[a]/255)*r,i(u,l(245,150,42,.34-c/3),d/2,h/2+125,s),i(u,l(245,65,22,.1-c/10),d/2,h/2+125,1.5*s),i(u,l(245,211,78,.5-c/5),d/2,h/2+125,.5*s)}u.restore()}var m=u.getImageData(0,0,d,h),w=m.data,S=w.length,b=m.width;for(a=0;a<S;a+=4)if(e.showNoise&&Math.random()<V&&(w[a]=w[a+1]=w[a+2]=0,w[a]=0),e.showInvert){var q=w[a],k=w[a+1],M=w[a+2];w[a]=255-q,w[a+1]=255-k,w[a+2]=255-M}if(e.showEmboss)for(a=0;a<S;a++)a%4!=3&&(w[a]=127+2*w[a]-w[a+4]-w[a+4*b]);u.putImageData(m,0,0)}(E),m.draw(u),w.draw(u),S.draw(u),b.draw(u)};window.onload=function(){console.log("window.onload called"),fetch("../data/av-data.json").then((function(e){if(!e.ok)throw new Error("HTTP error! Status: ".concat(e.status));return e.json()})).then((function(e){!function(e){document.querySelector("#title-av").innerHTML=e.title,document.querySelector("#heading-av").innerHTML=e.title,m=new T(e.spriteValues.x[0],e.spriteValues.y[0],e.spriteValues.radius[0],e.spriteValues.xMoveSpeed[0],e.spriteValues.yMoveSpeed[0],d,h),w=new T(e.spriteValues.x[1],e.spriteValues.y[1],e.spriteValues.radius[1],e.spriteValues.xMoveSpeed[1],e.spriteValues.yMoveSpeed[1],d,h),S=new T(e.spriteValues.x[2],e.spriteValues.y[2],e.spriteValues.radius[2],e.spriteValues.xMoveSpeed[2],e.spriteValues.yMoveSpeed[2],d,h),b=new T(e.spriteValues.x[3],e.spriteValues.y[3],e.spriteValues.radius[3],e.spriteValues.xMoveSpeed[3],e.spriteValues.yMoveSpeed[3],d,h),q=new Array(e.sounds.filenames[0],e.sounds.filenames[1],e.sounds.filenames[2]),new Array(e.sounds.track[0],e.sounds.track[1],e.sounds.track[2]),k=document.querySelector("#track-select");for(var t=0;t<3;t+=1){var n=document.createElement("option");n.text=e.sounds.track[t],n.value=e.sounds.filenames[t],k.add(n,null)}M=Object.freeze({sound1:q[0]})}(e),A()})).catch((function(e){return console.error("Error loading JSON:",e)}))}})();
//# sourceMappingURL=bundle.js.map